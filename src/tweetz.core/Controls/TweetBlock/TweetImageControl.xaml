<UserControl
  x:Class="tweetz.core.Controls.TweetImageControl"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:commands="clr-namespace:tweetz.core.Commands">

  <UserControl.Resources>
    <Style
      x:Key="BorderStyle"
      TargetType="Border">
      <Setter Property="Height" Value="200" />
      <Setter Property="Margin" Value="1" />
      <Setter Property="CornerRadius" Value="8" />
      <Setter Property="Cursor" Value="Hand" />
    </Style>

    <Style
      x:Key="UniformGridStyle"
      TargetType="UniformGrid">
      <Style.Triggers>
        <DataTrigger
          Binding="{Binding ItemsSource.Length, ElementName=ItemsControl, Mode=OneWay}"
          Value="2">
          <Setter Property="Rows" Value="1" />
        </DataTrigger>
      </Style.Triggers>
    </Style>
  </UserControl.Resources>

  <ItemsControl
    Name="ItemsControl"
    ItemsSource="{Binding ExtendedEntities.Media}">
    <ItemsControl.ItemTemplate>
      <DataTemplate>
        <Border Style="{StaticResource BorderStyle}">
          <Border.Background>
            <VisualBrush
              AlignmentY="Top"
              Stretch="UniformToFill">
              <VisualBrush.Visual>
                <Image
                  RenderOptions.BitmapScalingMode="LowQuality"
                  RenderOptions.CachingHint="Cache"
                  Source="{Binding MediaUrl}" />
              </VisualBrush.Visual>
            </VisualBrush>
          </Border.Background>

          <Border.InputBindings>
            <MouseBinding
              Command="{x:Static commands:ImageViewerCommand.Command}"
              CommandParameter="{Binding}"
              MouseAction="LeftClick" />
          </Border.InputBindings>
        </Border>
      </DataTemplate>
    </ItemsControl.ItemTemplate>

    <ItemsControl.ItemsPanel>
      <ItemsPanelTemplate>
        <UniformGrid Style="{StaticResource UniformGridStyle}" />
      </ItemsPanelTemplate>
    </ItemsControl.ItemsPanel>
  </ItemsControl>
</UserControl>